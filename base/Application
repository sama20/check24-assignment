<?php

namespace app\components;



/**
 * Here is the backbone of application. On this class every request and response comes.
 * 
 */
class Application 
{
    protected $_config;
    protected static $_app;
    /**
     * Start the application
     */
    public function run()
    {

        $this->preInit();

        $this->bootstrap();

    }

    private function __construct($config = [])
    {

        $this->_config = $config;
        Application::$_app = $this;
    }
    
    static function app()
    {
        return self::$_app;
    }

    public static function getInstance($config = [])
    {

        static $instance = null;
        // print_r(json_encode($config));die;
        if (null === $instance) {
            $instance = new static($config);
        }

        return $instance;
    }

  
    private function preInit()
    {
        // load configs
        $this->name = $this->_config['name'];


        // Inicialize all components
        if (is_array($this->_config['components'])) {
            
            foreach ($this->_config['components'] as  $component) {
                
                //TODO load component
            }
        }

        // handle requests and got to route
        // TODO: handle
    }

    
    private function bootstrap()
    {
        //TODO: luanch the project
    }


    private function resolveRoutes()
    {

        // TODO: routing
    }
}
